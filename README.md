# 🎄 Christmas Face Filter Mini-Game

AI 기반 얼굴 추적을 활용해 입을 벌려 선물을 먹고 석탄을 피하는 증강현실 미니게임입니다. 웹캠 앞에서 고개를 움직일 필요 없이, 입 위치와 벌림 정도만으로 플레이합니다. 난이도를 선택하고, 누적 점수와 모은 아이템을 확인하며 재도전할 수 있습니다.

## 목차
- [주요 기능](#주요-기능)
- [시스템 요구 사항](#시스템-요구-사항)
- [설치](#설치)
- [실행 방법](#실행-방법)
- [게임 플레이 가이드](#게임-플레이-가이드)
  - [아이템 종류](#아이템-종류)
  - [조작 및 단축키](#조작-및-단축키)
- [프로젝트 구조](#프로젝트-구조)
- [문제 해결 팁](#문제-해결-팁)

## 주요 기능
- **실시간 얼굴 추적**: MediaPipe Face Mesh로 입 중심 좌표와 입 벌림 비율을 계산합니다.
- **난이도 선택 랜딩 화면**: Easy / Normal / Hard 버튼 혹은 1·2·3 키로 난이도를 선택해 시작합니다.
- **아이템 수집 & 위험 요소**: 선물(present), 캔디(candy), 쿠키(cookie)는 입을 벌려야 획득할 수 있고, 석탄(coal)은 닿으면 라이프가 줄어듭니다.
- **시각적 피드백**: 라이프를 하트로 표시하고, 라이프 손실 시 화면 플래시, 실시간 피드백 텍스트, 수집 요약이 표시됩니다.
- **게임 오버 요약 & 리플레이**: 최종 점수와 아이템별 수량을 보여주고, Replay/Main Menu 버튼으로 손쉽게 재시작할 수 있습니다.
- **손 제스처 보너스**: 화면에 나타나는 손모양(Palm, Peace, Fist, Rock)을 따라 하면 보너스 점수가 지급됩니다.
- **제스처 파티클 오버레이**: 손 제스처를 인식해 화면 전체 파티클을 제어합니다. 두 손을 벌리면 파티클이 확장·폭발하고, 한 손으로 핀치하면 수축합니다.

## 시스템 요구 사항
- macOS / Windows / Linux 중 하나
- Python 3.9 이상 권장
- OpenCV가 접근할 수 있는 웹캠
- GPU는 필수 아님 (CPU에서도 동작)

## 설치
```bash
git clone <REPO_URL>
cd Christmas_Game
python -m venv .venv
source .venv/bin/activate  # Windows는 .venv\Scripts\activate
pip install -r requirements.txt
```

## 실행 방법
```bash
python src/main.py
```

1. 프로그램을 실행하면 카메라 영상과 함께 **Christmas Catch** 메뉴가 나타납니다.
2. 마우스로 난이도 버튼을 클릭하거나 숫자 키 `1`(Easy), `2`(Normal), `3`(Hard)을 눌러 시작합니다.
3. 웹캠 중앙에서 입을 카메라 쪽으로 향한 상태로 벌리며 선물을 수집합니다.
4. 게임 오버 시에는 화면 하단 버튼으로 **Replay**(같은 난이도 재시작) 또는 **Main Menu**(난이도 재선택)를 누릅니다.

## 게임 플레이 가이드
- **입 위치 = 플레이어 위치**: 머리 움직임 대신 입 중심이 캐릭터 역할을 합니다. 아이템은 화면 위에서 아래로 떨어집니다.
- **입을 벌려야만 획득**: 선물·캔디·쿠키는 입이 충분히 열려 있을 때만 점수가 오릅니다. 입이 닫힌 상태로 맞으면 라이프가 감소합니다.
- **속도·스폰 레이트**: 난이도에 따라 기본 속도, 랜덤 가속, 스폰 주기가 달라집니다. 레벨이 오를수록 속도가 더욱 빨라집니다.
- **라이프 & 피드백**: 하트로 표시되며, 라이프 손실 시 화면이 색깔별로 플래시됩니다. 라이프를 모두 잃으면 게임 오버입니다.
- **수집 요약**: 좌측 하단에 아이템별 수집 수가 실시간으로 업데이트되고, 게임 오버 화면에는 총합과 상세 목록이 표시됩니다.
- **손 제스처 보너스**: 좌측 상단에 표시되는 손모양을 손으로 따라 하면 `+40` 점수 보너스(난이도 배수 적용)를 획득합니다. Palm/Peace/Fist/Rock 네 가지가 랜덤으로 등장하며, 성공하면 새로운 손모양이 나타납니다. 성공 순간에는 화면 전체를 덮는 파티클 폭발로 시각적 피드백을 줍니다.

### 아이템 종류
| 아이템 | 타입 | 기본 점수* | 효과 |
| --- | --- | --- | --- |
| Present | Collectible | 10 | 입을 벌린 상태로 맞으면 점수 획득 |
| Candy Cane | Collectible | 15 | 난이도 배수를 곱한 추가 점수 |
| Ginger Cookie | Collectible | 20 | 가장 높은 점수, 드물게 등장 |
| Coal | Hazard | - | 닿으면 라이프 감소, 피해야 함 |


\* 실제 점수는 난이도별 score multiplier(Easy 1.0 / Normal 1.15 / Hard 1.35)가 적용됩니다.

### 손 제스처 보너스
- **표시 위치**: 좌측 상단 카드에 현재 요구되는 손모양(PALM, PEACE, FIST, ROCK 중 하나)이 아이콘으로 표시됩니다.
- **획득 방법**: 해당 손모양을 카메라에 비추면 "MATCH" 메시지가 뜨고, 정확히 따라 했을 때 `+40` 점수(난이도 배수 적용)가 즉시 추가됩니다.
- **쿨다운**: 보너스를 받으면 약 2초간 축하 표시가 나온 뒤 새로운 손모양이 랜덤으로 선택됩니다.
- **파티클 피드백**: 두 손을 화면 양쪽으로 벌릴수록 파티클이 확장되고, 손을 오므리면 수축합니다. 보너스 성공 시 손모양 카드 주변에서 강한 폭발 효과가 나타납니다.
- **팁**: 손바닥이 잘 보이도록 카메라 가까이, 손가락이 겹치지 않게 펼치면 인식률이 높아집니다. FIST/ROCK은 손가락을 뚜렷하게 접거나 펴 주세요.

### 조작 및 단축키
- `마우스 클릭` : 메뉴/리플레이 버튼 선택
- `1 / 2 / 3` : 메뉴 상태에서 난이도 선택 (Easy / Normal / Hard)
- `p` : 플레이 중 일시정지/재개
- `r` : 게임 오버 이후 같은 난이도로 즉시 재시작
- `q` : 게임 종료

## 프로젝트 구조
```
Christmas_Game/
├── assets/
│   ├── candy.png
│   ├── coal.png
│   ├── cookie.png
│   └── present.png
├── requirements.txt
└── src/
    ├── filter_logic.py   # MediaPipe 초기화, 입/눈 거리 계산, Head Pose 유틸
    ├── game_logic.py     # 게임 상태, 아이템 스폰, 충돌 판정, HUD 렌더링
    └── main.py           # 카메라 루프, 난이도 메뉴, 입력 처리
```

## 문제 해결 팁
- **폰트가 깨질 때**: README에 명시된 것처럼 메뉴 텍스트는 ASCII로 구성되어 있습니다. 그래도 깨진다면 OpenCV에서 한글 폰트를 지원하지 않는 경우이므로, `draw_menu_overlay`와 `draw_buttons` 문구를 추가로 편집하세요.
- **카메라 접근 오류**: 다른 앱이 웹캠을 사용 중인지 확인하고, macOS/Windows에서 Python의 카메라 접근 권한을 허용해야 합니다.
- **버튼이 클릭되지 않을 때**: 창이 최소화되어 있거나 비율이 바뀌면 클릭 좌표가 어긋날 수 있습니다. `cv2.namedWindow(..., cv2.WINDOW_NORMAL)` 과 `cv2.resizeWindow` 호출이 있으므로, 창을 수동으로 늘렸다면 한 번 더 메뉴로 돌아가 새로고침하세요.
- **손 제스처가 인식되지 않을 때**: 손바닥을 카메라 방향으로 두고, 조명이 밝은 환경에서 배경과 손 색 대비를 높이면 MediaPipe Hands 인식률이 올라갑니다.

즐거운 크리스마스 게임 플레이 되세요! 
